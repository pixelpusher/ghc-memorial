<!DOCTYPE html>
<html lang="en">
	<head>
    <title>Spreadsheets via sheetrock test 2</title>

    <link rel="stylesheet" type="text/css" href="http://chriszarate.github.io/sheetrock/src/sheetrock.min.css">
        
    <style type="text/css">
    	#loading {
    		font-size: 36px;
    		font-weight: bold;
    	}
    </style>

    <script type="text/javascript">
    	window.addEventListener('load', function ()
    	{
            // Compile the Handlebars template for HR leaders.
            var PeopleTemplate = Handlebars.compile($('#people-template').html());  
            
    		// Define spreadsheet URL.
			var mySpreadsheet = 'https://docs.google.com/spreadsheet/ccc?key=1qM3kEVwzSg9sgYVfhibaF5jQdiw3E40ZVtaukCZugX4#gid=0';
			console.log('loading');
			// Load an entire sheet.
			$('#people').sheetrock({
				url: mySpreadsheet,
				//sql: "select A,B,D,E where A = 'Smith/CWGC/Anc' order by B asc",
                sql: "select A,C,F,P where C contains 'Al' order by C asc",
  				chunkSize: 25, // 300 rows
                headersOff: true,
                rowHandler: PeopleTemplate,
  				loading: $('#loading')
			});
    	});
    </script>
  
 	</head>
	
	<body>

		<p>This example only shows the results from Charleton in the spreadsheet.  That's what the "C=Smith/CWGC/Anc" means in the Javascript above.  Also, it sorts the rows by last name (B) in ascending order.</p>

		<div id="loading">Loading...</div>
		
        <table id="stats" class="table table-condensed table-striped"></table>

        <h4>People</h4>
        <ol id="people">
          <script id="people-template" type="text/x-handlebars-template">
            <li>
              <strong>{{cells.surname}}, {{cells.forenames}}</strong>,
              {{cells.cemeterymemorial}}
            </li>
          </script>
        </ol>
        
	<!-- https://docs.google.com/spreadsheets/d/1Nn50GZXtwhDZVIiOqFBgsQ40N6gyPHyz0yYiJDiByrs/pubhtml -->

    <!-- https://docs.google.com/spreadsheets/d/1qM3kEVwzSg9sgYVfhibaF5jQdiw3E40ZVtaukCZugX4/edit?usp=sharing -->
     
    <!-- Load jQuery from CloudFlare’s CDN. -->
	<script src="http://cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.1.2/handlebars.min.js"></script>

        
        
    <!-- Load jQuery from CloudFlare’s CDN. -->
	<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

	<!-- sheetrock for google spreadsheets API -->
    <script src="http://chriszarate.github.io/sheetrock/src/jquery.sheetrock.min.js"></script>


  </body>
</html>